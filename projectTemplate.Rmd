TITLE by YOUR_NAME_HERE
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
# Load all of the packages that you end up using
# in your analysis in this code chunk.

# Notice that the parameter "echo" was set to FALSE for this code chunk.
# This prevents the code from displaying in the knitted HTML output.
# You should set echo=FALSE for all code chunks in your file.

library(ggplot2)
library(gridExtra)
```

```{r echo=FALSE, Load_the_Data}
# Load the Data
wqr<-read.csv('wineQualityReds.csv')
c(nrow(wqr), ncol(wqr))
summary(wqr)
```
The red wine quality datasetcontains 1599 obeservations with 12 attributes. 11 of the attributes are objective measures of a red wine and 1 attribute is median subjective rating by wine experts. 

# Univariate Plots Section
```{r echo=FALSE, Univariate_Plots}
g1<-ggplot(data=wqr,aes(x=fixed.acidity))+
  geom_histogram(bins=45)

g2<-ggplot(data=wqr,aes(x=volatile.acidity))+
  geom_histogram(bins=45)

g3<-ggplot(data=wqr,aes(x=citric.acid))+
  geom_histogram(bins=20)

grid.arrange(g1,g2,g3,ncol=3)

summary(wqr$fixed.acidity)
summary(wqr$volatile.acidity)
summary(wqr$citric.acid)

```
Fixed.acidity and volatile.acidity have roughly normal distributions. Amount of volatile.acidity is very low with a mean of 0.53 g/dm^3. The citric acid is also found in small quantitis in red wines with a mean if 0.27 g/dm^3.

```{r}
ggplot(data=wqr,aes(x=residual.sugar))+
  geom_histogram(bins=50)

summary(wqr$residual.sugar)

nrow(subset(wqr,residual.sugar<1))
```
The amount of residual sugar is small with a mean of 2.5 g/litre. According to dataset descitiption a wine with more than 45 g/litre of residual sugar is considered sweet wine. However in the given dataset the maximum residual sugar is 15.5 g/litre. The descripion also notes that a wine less than 1 g/litre residual sugar is rare. In the given dataset there are two wines with less than 1 g/litre residual sugar. I personally like sweet wines. I am curious if it has any relationship with quality of a wine.

```{r}
g1<-ggplot(data=wqr,aes(x=chlorides))+
  geom_histogram(bins=40)

g2<-ggplot(data=wqr,aes(x=chlorides))+
  geom_histogram(bins=100)+
  coord_cartesian(xlim = c(0.012,quantile(wqr$chlorides,0.95)))

grid.arrange(g1,g2,ncol=2)

summary(wqr$chlorides)
```
The attribute chloride represents amount of salt in a wine. Most of the wines have small amount of salt less than 0.2. To see proper distribution of amount of salt in most of the wines, we put a limit on x-axis to show maximum salt amount at 95% quatile (Please refer to above second plot). 

```{r}
g1<-ggplot(data=wqr,aes(x=free.sulfur.dioxide))+
  geom_histogram(bins=40)

g2<-ggplot(data=wqr,aes(x=total.sulfur.dioxide))+
  geom_histogram(bins=40)


g3<-ggplot(data=wqr,aes(x=free.sulfur.dioxide))+
  geom_histogram(bins=30)+
  scale_x_log10()

g4<-ggplot(data=wqr,aes(x=total.sulfur.dioxide))+
  geom_histogram(bins=30)+
  scale_x_log10()

grid.arrange(g1,g2,g3,g4,ncol=2)
```
The above plot show amount of free and total sulphur dioxide in wines. From the top row of the above plot we see that distribution of amount is skewed with long tails. The bottom row of the plot show when the amount is log transformed.

```{r}
g1<-ggplot(data=wqr,aes(x=density))+
  geom_histogram(bins=30)

g2<-ggplot(data=wqr,aes(x=pH))+
  geom_histogram(bins=30)

grid.arrange(g1,g2,ncol=2)
```
The above plot shows distribution of density and pH level of wines. The density for most of the wines is little less than 1 which is the density of water. Also, most of the wines are in the 3 and 3.7 which is acidic.


```{r}
ggplot(data=wqr,aes(x=alcohol))+
  geom_histogram(bins=40)

summary(wqr$alcohol)
```
The mean percent of alcohol is 10.42%. 75% of wines have alcohol content less than 11.1%. It would be interesting to see if Alcohol content has any correlation with the quality of a wine.

```{r}
ggplot(data=wqr,aes(x=quality))+
  geom_bar(bins=6,breaks=c(3,4,5,6,7,8))
summary(wqr$quality)
table(wqr$quality)
#wqr$quality.bucket <- cut(wqr$quality,breaks = c(0,4,6,10))
```
Most of the wines have quality rating of 5 and 6. The highset possible rating is 10 but none of the wines in the dataset have got full rating. 18 of the wines have got quality rating of 8 (maximum rating in the dataset). It would e interesting to see what all objective measures relate with these ratings.

# Univariate Analysis

### What is the structure of your dataset?
There are 1599 wines in the dataset with 12 attributes. 11 of the attributes are objective measures and one attribute is subjective quality rating.

### What is/are the main feature(s) of interest in your dataset?
I think the main features are volatile acidity, residual sugar, and alcohol content. I suspect these features will have either positive or negative correlations with quality ratings.

### What other features in the dataset do you think will help support your investigation into your feature(s) of interest?
I think pH and total sulfur dioxide might also influence the subjective quality ratings.

### Did you create any new variables from existing variables in the dataset?
I did not make any new variable. As all the variales were on continous scale and most of them were normally distributed. If any of the variables had uniform distribution I would have made that variable into a categorical variable using cut function. However, for the given dataset I did not feel any need of it.

### Of the features you investigated, were there any unusual distributions? Did you perform any operations on the data to tidy, adjust, or change the form of the data? If so, why did you do this?
I found distriution of Chlorides as unusual. It has normal distriution, but with a very long tail. To make the plot look tidy, I limited x coordinate to have max value of 95% qualtile of choloride quantity. Similarly, free the distribution of free sulphur dioxide and total sulfur dioxide seemed skewed with long tails. I transformed x using log10 transformation. The resulting plot looks more normal now.


# Bivariate Plots Section
```{r echo=FALSE, Bivariate_Plots}
library(GGally)
wqr<-wqr[,2:ncol(wqr)]
```
```{r}
ggpairs(wqr, 
  lower = list(continuous = wrap("points", shape = I('.'))), 
  upper = list(combo = wrap("box", outlier.shape = I('.'))))
```
From the above plots we do not see that Quality has strong correlations with any of the other attributes. The quality rating has best positive correlation of 0.48 with alcohol content and best negative correlation of -0.39 with volatile.acidity. Lets take a close look at these correlations.

```{r}
ggplot(data = wqr,aes(alcohol,quality))+
  geom_point()
```

```{r}
g1<-ggplot(data = wqr,aes(alcohol,quality))+
  geom_jitter()+
  geom_smooth(method = 'lm')
  
g2<-ggplot(data = wqr,aes(quality,alcohol))+
  geom_line(stat = 'summary', fun.y=median,size=1)
grid.arrange(g1,g2,ncol=2)
  
```
And indeed the scatter plot shows a weak positive correlation between the quality and the alchol content.

```{r}
ggplot(data = wqr,aes(volatile.acidity,quality))+
  geom_point()
```
```{r}
g1<-ggplot(data = wqr,aes(volatile.acidity,quality))+
  geom_jitter()+
  geom_smooth(method = 'lm')
g2<-ggplot(data = wqr,aes(quality,volatile.acidity))+
  geom_line(stat = 'summary', fun.y=median,size=1)
grid.arrange(g1,g2,ncol=2)
```
 This plot shows that as the content of volatile acidity increases the quality reating decreases and hence has a negative correlation.

```{r}
g1<-ggplot(data = wqr,aes(residual.sugar,quality))+
  geom_jitter()+
  geom_smooth(method = 'lm')

g2<-ggplot(data = wqr,aes(quality,residual.sugar))+
  geom_line(stat = 'summary', fun.y=median,size=1)
grid.arrange(g1,g2,ncol=2)

cor.test(wqr$residual.sugar,wqr$quality)
```
I suspected that the residual sugar will be a good predictor of quality. However, the plot suggests that there is no relationship between the amount of residual sugar and the quality of a wine.

```{r}
g1<-ggplot(data = wqr,aes(fixed.acidity,citric.acid))+
  geom_point()+
  geom_smooth(method = 'lm')
g2<-ggplot(data = wqr,aes(fixed.acidity,density))+
  geom_point()+
  geom_smooth(method = 'lm')
g3<-ggplot(data = wqr,aes(fixed.acidity,pH))+
  geom_point()+
  geom_smooth(method = 'lm')
g4<-ggplot(data = wqr,aes(free.sulfur.dioxide,total.sulfur.dioxide))+
  geom_point()+
  geom_smooth(method = 'lm')
grid.arrange(g1,g2,g3,g4,ncol=4)
```
The above plot shows some of the strong relationships between other attributes. 
# Bivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. How did the feature(s) of interest vary with other features in the dataset?
I suspected that volatile acidity, residual sugar, and alcohol content will be a strong predictor of quality. However, looking at the scatter plot we do not see any strong relationships. The best positive correlation of qiuality is of 0.48 with alcholo content. In the description of the attributes, it was mentioned that high levels of volatile acidity can lead to an unpleasent taste. Indeed the scatter plot revealed a negative correlation of -0.39. The amount of residual sugar did not show any relationship with the quality rating. I might be biased by my personal preferences of sweet red wines. 

### Did you observe any interesting relationships between the other features (not the main feature(s) of interest)?
Yes I found other strong correlations between fixed acidity and citric acid, fixed acidity and density, fixed acidity and pH, and free sulphur dioxide and total sulphur dioxide. Most of these makes sense but I did not understand why acidity is correlated with density. 

### What was the strongest relationship you found?
The strogest relationship (correlation=-0.68) was between free acidity and pH value. This was expected because pH  value is used to measure acidity of any aqueous solution.



# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}
library(RColorBrewer)
theme_set(theme_classic(20))
ggplot(data = wqr,aes(alcohol,volatile.acidity))+
  geom_jitter(aes(color=factor(quality)))+
  geom_smooth(method = 'lm')+
  scale_color_brewer(type = 'qual')
```
This plot clearly shows that wines with low alcohol content and high volitile acidit are rated low (shown in green points). 

```{r echo=FALSE}
theme_set(theme_classic(20))
ggplot(data = wqr,aes(citric.acid,residual.sugar))+
  geom_jitter(aes(color=factor(quality)),alpha=0.5)+
  facet_wrap(~factor(quality))+
  scale_color_brewer(type = 'qual')
```
In this plot also we do not see any strong combined effect of residual.sugar and citric.acid in the quality ratings.

```{r Building the Linear Model}
library(memisc)
m1 <- lm(quality ~ alcohol, data = wqr)
m2 <- update(m1, ~ . + volatile.acidity)
m3 <- update(m2, ~ . + sulphates)
m4 <- update(m3, ~ . + citric.acid)
m5 <- update(m4, ~ . + total.sulfur.dioxide)
mtable(m1, m2, m3, m4, m5)
summary(m5)
```
The attributes included in the linear model (alcohol, volatile.acidity, sulphates, citric.acid, total.sulfur.dioxide) can account for only 34% of the variance in the quality ratings.

# Multivariate Analysis

### Talk about some of the relationships you observed in this part of the investigation. Were there features that strengthened each other in terms of looking at your feature(s) of interest?
We did not find any pairs of attributes which together were a good predictor of quality. In the second plot above (residual.sugar vs Citric.acid) we see that wines of wines with same quality ratings are all over the plot regions, indicating no strong relationships. Except for wines with quality rating of 3 have small amount of citric.acis, but there also exists many highly rated wines with low citric.acid.

### Were there any interesting or surprising interactions between features?
Even though individual attributes do not have strong relationships with quality, I expected that together they would be good predictor of the quality. However, non of the multivariate plot showed any indication improvement with combinations of attriutes. 

### OPTIONAL: Did you create any models with your dataset? Discuss the strengths and limitations of your model.
Yes, I made five linear models to predict the quality ratings. However, the maximum variance the best model could predict is 34%. I think either some other objective measures are also required or there is complex non-linear relationship in high-dimensions between quality and the objective attriutes which are not apparent in scatter plots.
------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}
ggplot(data=wqr,aes(x=quality))+
  geom_bar()+
  ylab('Number of red wines')+
  ggtitle('Quyality ratings of wine')
```

### Description One


### Plot Two
```{r echo=FALSE, Plot_Two}
g1<-ggplot(data = wqr,aes(alcohol,quality))+
  geom_jitter()+
  geom_smooth(method = 'lm')+
  ggtitle('Quality Vs. Alcohol')+
  ylab('Quality')+
  xlab('Alcohol (% by volume)')
  
g2<-ggplot(data = wqr,aes(quality,alcohol))+
  geom_line(stat = 'summary', fun.y=median,size=2, color='red')+
  ggtitle('Median alchol content')+
  xlab('Quality')+
  ylab('Alcohol (% by volume)')
grid.arrange(g1,g2,ncol=2)
```

### Description Two


### Plot Three
```{r echo=FALSE, Plot_Three}
g1<-ggplot(data = wqr,aes(volatile.acidity,quality))+
  geom_jitter()+
  geom_smooth(method = 'lm')+
  ggtitle('Quality Vs. Volatile Acidity')+
  ylab('Quality')+
  xlab('Volatile Acidity (g/dm^3)')

g2<-ggplot(data = wqr,aes(quality,volatile.acidity))+
  geom_line(stat = 'summary', fun.y=median,,size=2, color='red')+
  ggtitle('Median Volatile Acidity content')+
  xlab('Quality')+
  ylab('Volatile Acidity (g/dm^3)')
grid.arrange(g1,g2,ncol=2)
```

### Description Three

------

# Reflection
